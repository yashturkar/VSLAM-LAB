[workspace]
name = "VSLAM-LAB"
version = "0.1.0"
description = "VSLAM-LAB"
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[tasks]
clean-swap = { cmd = "sudo /sbin/swapoff -a && sudo /sbin/swapon -a" }
kill-all = { cmd = "pkill -f -e 'droidslam|mast3rslam|dpvo|monogs|orbslam2|colmap|glomap|gensfm|mast3r|vggt|pycuvslam|vslamlab' && sudo /sbin/swapoff -a && sudo /sbin/swapon -a" } 

[environments]
vslamlab = { features = ["vslamlab"]}
cuda126 = { features = ["cuda126"], solve-group = "cuda126" }
py10 = { features = ["py10"], solve-group = "py10" }
py11 = { features = ["py11"], solve-group = "py11" }
x11 = { features = ["x11"], solve-group = "x11" }
opengl = { features = ["opengl"], solve-group = "opengl" }

droidslam = { features = ["droidslam"] }
mast3rslam = { features = ["mast3rslam"] }
dpvo = { features = ["dpvo"] }
monogs = { features = ["monogs"] }
orbslam2 = { features = ["orbslam2"] }
anyfeature = { features = ["anyfeature"] }
colmap = { features = ["colmap"], solve-group = "colmap" }
glomap = { features = ["glomap", "colmap"], solve-group = "colmap" }

orbslam3 = { features = ["orbslam3"] }
okvis2 = { features = ["okvis2"] }
pycuvslam = { features = ["pycuvslam","cuda126", "py10"] }

droidslam-dev = { features = ["droidslam-dev", "cuda126", "py11"], solve-group = "cuda126py11" }
mast3rslam-dev = { features = ["mast3rslam-dev", "cuda126", "py11"], solve-group = "cuda126py11" }
dpvo-dev = { features = ["dpvo-dev", "cuda126", "py11", "x11", "opengl"], solve-group = "cuda126py11" }
monogs-dev = { features = ["monogs-dev", "cuda126", "py10"], solve-group = "cuda126py10" }
orbslam2-dev = { features = ["orbslam2-dev", "x11", "opengl"] }
anyfeature-dev = { features = ["anyfeature-dev", "x11", "opengl"] }
gensfm-dev = { features = ["gensfm-dev", "cuda126", "py10", "x11", "opengl"], solve-group = "cuda126py10" }
mast3r-dev = { features = ["mast3r-dev", "cuda126", "py10"], solve-group = "cuda126py10" }
vggt-dev = { features = ["vggt-dev", "cuda126", "py11"], solve-group = "cuda126py11" }

orbslam3-dev = { features = ["orbslam3-dev", "x11", "opengl"] }
okvis2-dev = { features = ["okvis2-dev", "cuda126", "py11"] }

# VSLAM-LAB main pipeline    
[feature.vslamlab]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.vslamlab.tasks]
vslamlab.cmd = "python vslamlab_gui.py vslamlab {{ exp_yaml }} {{ overwrite }}"
vslamlab.args = [
  { "arg" = "exp_yaml", "default" = "configs/exp_vslamlab.yaml" },
  { "arg" = "overwrite", "default" = " " },
]

evaluate.cmd = "python vslamlab_gui.py evaluate_exp {{ exp_yaml }} {{ overwrite }}"
evaluate.args = [
  { "arg" = "exp_yaml", "default" = "configs/exp_debug.yaml" },
  { "arg" = "overwrite", "default" = " " },
]

compare.cmd = "python vslamlab_gui.py compare_exp {{ exp_yaml }}"
compare.args = [
  { "arg" = "exp_yaml", "default" = "configs/exp_debug.yaml" }
]

eval-metrics.cmd = "python vslamlab_gui.py eval_metrics {{ exp_yaml }}"
eval-metrics.args = [
  { "arg" = "exp_yaml", "default" = "configs/exp_debug.yaml" }
]

eval-metrics-single.cmd = "python vslamlab_gui.py eval_metrics_single {{ config_yaml }}"
eval-metrics-single.args = [
  { "arg" = "config_yaml", "default" = "configs/single_lightning.yaml" }
]

vslamlab-debug.depends-on = [{ "task" = "vslamlab", "args" = ["configs/exp_debug.yaml", "--overwrite"] }]
vslamlab-allfeature = [{ "task" = "vslamlab", "args" = ["configs/exp_allfeature.yaml", "--overwrite"] }]
demo = "python vslamlab_gui.py demo"

evaluate-debug.depends-on = [{ "task" = "evaluate", "args" = ["configs/exp_debug.yaml", "--overwrite"] }]
evaluate-allfeature = [{ "task" = "evaluate", "args" = ["configs/exp_allfeature.yaml", "--overwrite"] }]
compare-debug.depends-on = [{ "task" = "compare", "args" = ["configs/exp_debug.yaml"] }]
compare-allfeature = [{ "task" = "compare", "args" = ["configs/exp_allfeature.yaml"] }]

# VSLAM-LAB info functions   
baseline-info = "python vslamlab_gui.py baseline_info"
print-baselines = "python vslamlab_gui.py print_baselines"
print-datasets = "python vslamlab_gui.py print_datasets"
set-benchmark-path  = "python path_constants.py set_VSLAMLAB_BENCHMARK_path"
set-evaluation-path = "python path_constants.py set_VSLAMLAB_EVALUATION_path"

# VSLAM-LAB pipeline functions
validate-experiment-yaml = "python vslamlab_gui.py validate_experiment_yaml"
overwrite-exp = "python vslamlab_gui.py overwrite_exp"
update-experiment-csv-logs = "python vslamlab_gui.py update_experiment_csv_logs"

check-experiment-resources = "python vslamlab_gui.py check_experiment_resources"
get-experiment-resources = "python vslamlab_gui.py get_experiment_resources"

check-experiment-state = "python vslamlab_gui.py check_experiment_state"

install-baseline = "python vslamlab_gui.py install_baseline"
install-baselines = "python vslamlab_gui.py install_baselines"

download-sequence = "python vslamlab_gui.py download_sequence"
download-sequences = "python vslamlab_gui.py download_sequences"
download-dataset = "python vslamlab_gui.py download_dataset"

run-exp = "python vslamlab_gui.py run_exp"
evaluate-exp = "python vslamlab_gui.py evaluate_exp"
compare-exp = "python vslamlab_gui.py compare_exp"

[feature.vslamlab.dependencies]
python = "*"
pyyaml = "*"
matplotlib = "*"
pandas = "*"
py-opencv = "*"
scipy = "*"
requests = "*"
inputimeout = "*"
scikit-learn = "*"
tqdm = "*"
google-api-python-client = "*"
google-auth-oauthlib = "*"
huggingface_hub = "*"
py7zr = "*"
exifread = "*"
pyproj = "*"
nvidia-ml-py = "*"
evo = "*"
git-lfs = "*"
piexif = "*"
psutil = "*"

########################################################################################################################
########################################################################################################################
# droidslam 
[feature.droidslam]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.droidslam.system-requirements]
cuda = "12.0"

[feature.droidslam.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/droidslam Baselines/DROID-SLAM'
execute-mono = 'vslamlab_droidslam_mono'
execute-rgbd = 'vslamlab_droidslam_rgbd'
execute-stereo = 'vslamlab_droidslam_stereo'

[feature.droidslam.dependencies]
droidslam = "*"
lietorch = { version = "*", channel = "fontan" }  
open3d = ">=0.18.0,<0.19"

# ########################################################################################################################
# ########################################################################################################################
# mast3rslam 
[feature.mast3rslam]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.mast3rslam.system-requirements]
cuda = "12.0"

[feature.mast3rslam.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/mast3rslam Baselines/MASt3R-SLAM'
execute-mono = 'vslamlab_mast3rslam_mono'

[feature.mast3rslam.dependencies]
mast3rslam = { channel = "fontan" }
lietorch = { channel = "fontan" }
moderngl-window = { channel = "fontan" }
roma = { channel = "fontan" }

########################################################################################################################
########################################################################################################################
# dpvo
[feature.dpvo]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.dpvo.system-requirements]
cuda = "12.0"

[feature.dpvo.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/dpvo Baselines/DPVO'
execute-mono = 'vslamlab_dpvo_mono'

[feature.dpvo.dependencies]
dpvo = { channel="fontan" }
pangolin = { channel="fontan" }
pypose = { channel="fontan" }
opencv = "*"
evo = "*"
yacs = "*"
pytorch_scatter = "*"
einops = "*"   
numba = "*"

########################################################################################################################
########################################################################################################################
# monogs
[feature.monogs]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.monogs.system-requirements]
cuda = "12.0"

[feature.monogs.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/monogs Baselines/MonoGS'
execute-mono = 'vslamlab_monogs_mono'

[feature.monogs.dependencies]
monogs = { channel="fontan" }
pytorch-gpu = "*"
munch = "*"
wandb = "*"
plyfile = "*"
opencv = "*"
pyglfw = "*"
imgviz = "*"
pyopengl = "*"
pyglm = "*"
rich = "*"
trimesh = "*"
evo = "*"
torchmetrics = "*"

[feature.monogs.pypi-dependencies]
open3d = "==0.17.0"

########################################################################################################################
########################################################################################################################
# orbslam2
[feature.orbslam2]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.orbslam2.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/orbslam2 Baselines/ORB_SLAM2'
execute-mono = 'vslamlab_orbslam2_mono'
execute-rgbd = 'vslamlab_orbslam2_rgbd'
execute-stereo = 'vslamlab_orbslam2_stereo'

[feature.orbslam2.dependencies]
orbslam2 = { channel="fontan" }
pangolin = { channel="fontan" }
opencv = ">=4.10.0 ,<5"

########################################################################################################################
########################################################################################################################
# anyfeature
[feature.anyfeature]
channels = ["fontan", "https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.anyfeature.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/anyfeature Baselines/AnyFeature-VSLAM'
execute-mono = 'vslamlab_anyfeature_mono'

[feature.anyfeature.dependencies]
anyfeature = { channel="fontan" }
pangolin = { channel="fontan" }
brisk = { channel="fontan" }
akaze = { channel="fontan" }
siftgpu = { channel="fontan" }
g2o = { channel="fontan" }
opencv = { channel="fontan" }

########################################################################################################################
########################################################################################################################
# colmap
[feature.colmap]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.colmap.system-requirements]
cuda = "12.6"

[feature.colmap.tasks]
git-clone = { cmd = 'git clone https://huggingface.co/vslamlab/colmap', cwd = 'Baselines' }
execute-mono = './Baselines/colmap/colmap_reconstruction.sh'

[feature.colmap.dependencies]
colmap = { build="*cuda*" }
yq = "*"
numpy = "*"
scipy = "*"
pandas = "*"

########################################################################################################################
########################################################################################################################
# glomap
[feature.glomap]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.glomap.system-requirements]
cuda = "12.6"

[feature.glomap.tasks]
git-clone = { cmd = 'git clone https://huggingface.co/vslamlab/glomap', cwd = 'Baselines' }
execute-mono = { cmd = './Baselines/glomap/glomap_reconstruction.sh' }

[feature.glomap.dependencies]
glomap = { build="*cuda*"}

########################################################################################################################
########################################################################################################################
# orbslam3
[feature.orbslam3]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.orbslam3.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/orbslam3 Baselines/ORB_SLAM3'
execute-mono_vi = 'vslamlab_orbslam3_mono_vi'

[feature.orbslam3.dependencies]
orbslam3 = { channel="fontan" }
pangolin = { channel="fontan" }
opencv = ">=4.10.0 ,<5"

########################################################################################################################
########################################################################################################################
# okvis2
[feature.okvis2]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.okvis2.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/okvis2 Baselines/OKVIS2'
execute-mono_vi = 'vslamlab_okvis2_mono_vi'

[feature.okvis2.dependencies]
okvis2 = { channel="fontan" }

########################################################################################################################
########################################################################################################################
# pycuvslam
[feature.pycuvslam]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.pycuvslam.system-requirements]
cuda = "12.0"

[feature.pycuvslam.tasks]
git-clone = './git-clone.sh VSLAM-LAB PyCuVSLAM PyCuVSLAM'
install = { cmd = "pip install -e bin/x86_64", cwd = "Baselines/PyCuVSLAM" }
execute-rgbd = { cmd = 'export LD_LIBRARY_PATH=$CONDA_PREFIX/lib:$LD_LIBRARY_PATH && python vslamlab_pycuvslam_rgbd.py',  cwd = 'Baselines/PyCuVSLAM' }

[feature.pycuvslam.dependencies]
libstdcxx-ng = "*"
numpy = "=2.2.4"
pillow = "=11.1.0"
pyyaml = "=6.0.2"
rerun-sdk = "=0.22.1"
scipy = "=1.14.1"
pandas = "*"
opencv = "*"

########################################################################################################################
########################################################################################################################
################################################ DEVELOPMENT PACKAGES ##################################################
########################################################################################################################
########################################################################################################################

# ########################################################################################################################
# ########################################################################################################################
# cuda126 
[feature.cuda126]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.cuda126.system-requirements]
cuda = "12.0"

[feature.cuda126.dependencies]
# CUDA Build Tools
cuda-compiler = "*"
cuda-version = "12.6.*"
cuda-cudart-dev = "*"
cuda-crt = "*"
libcusparse-dev = "*"
cuda-driver-dev = "*"
cuda-nvcc = "*"
cuda-nvrtc-dev = "*"
cuda-nvtx = "*"
cuda-nvtx-dev = "*"
cuda-nvml-dev = "*"
cuda-profiler-api = "*"

# CUDA Libraries
cudnn = "*"
libcublas-dev = "*"
libcudss-dev = "*"
libcufile-dev = "*"
libcufft-dev = "*"
libcurand-dev = "*"
libcusolver-dev = "*"
cusparselt = "*"
libnvjitlink = "*"

# ########################################################################################################################
# py10
[feature.py10]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.py10.dependencies]
python = "3.10.*"
setuptools = "*"
pip = "*"

# ########################################################################################################################
# py11
[feature.py11]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.py11.dependencies]
python = "3.11.*"
setuptools = "*"
pip = "*"

# ########################################################################################################################
# x11
[feature.x11]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.x11.dependencies]
xorg-libxext = "*"
xorg-libx11 = "*"
xorg-libxfixes = "*"
xorg-libxrender = "*"
xorg-libice = "*"
xorg-libsm = "*"
xorg-libxdmcp = "*"
xorg-libxau = "*"
xorg-xorgproto = "*"
libxkbcommon = "*"

# ########################################################################################################################
# opengl
[feature.opengl]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.opengl.dependencies]
libgl-devel = "*"
libegl-devel = "*"
libglvnd-devel = "*"
libopengl-devel = "*"

########################################################################################################################
########################################################################################################################
# droidslam-dev
[feature.droidslam-dev]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.droidslam-dev.system-requirements]
cuda = "12.0"

[feature.droidslam-dev.tasks]
git-clone = "./git-clone.sh VSLAM-LAB DROID-SLAM DROID-SLAM-DEV"
install = { cmd = "python setup.py install", cwd = "Baselines/DROID-SLAM-DEV" }
execute-mono = { cmd = 'python vslamlab_droidslam_mono.py',  cwd = 'Baselines/DROID-SLAM-DEV' }
execute-rgbd = { cmd = 'python vslamlab_droidslam_rgbd.py',  cwd = 'Baselines/DROID-SLAM-DEV' }
execute-stereo = { cmd = 'python vslamlab_droidslam_stereo.py',  cwd = 'Baselines/DROID-SLAM-DEV' }
#train = {cmd = 'python train.py --iters 1 --steps 50000 --lr 0.000025 --datapath /home/fontan/VSLAM-LAB-Benchmark/TartanAir --ckpt "droid.pth"',  cwd = 'Baselines/DROID-SLAM-DEV'}

train.cmd =  'python train.py --iters {{ iters }} --steps {{ steps }} --lr {{ lr }} --datapath {{ datapath }} --ckpt {{ ckpt }}'
train.cwd =  'Baselines/DROID-SLAM-DEV'
train.args = [
  { "arg" = "iters", "default" = "1" },
  { "arg" = "steps", "default" = "50000" },
  { "arg" = "lr", "default" = "0.000025" },
  { "arg" = "datapath", "default" = "/home/fontan/VSLAM-LAB-Benchmark/TartanAir" },
  { "arg" = "ckpt", "default" = "droid.pth" },
]

[feature.droidslam-dev.dependencies]
# Build Tools
compilers = "*"
cmake = "*"
make = "*"

# Specialized Libraries
lietorch = { version = "*", channel = "fontan" }  

# Core Libraries
pytorch-gpu = "*"
opencv = "*"
torch-scatter = "*"
torchvision = "*"
tensorboard = "*"

# Logging, Evaluation & Visualization
open3d = ">=0.18.0,<0.19"
scipy = ">=1.14.1,<2"
suitesparse = ">=7.8.2,<8"
matplotlib = ">=3.9.2,<4"
pyyaml = ">=6.0.2,<7"
huggingface_hub = "*"
tqdm = "*"
pandas = "*"

# ########################################################################################################################
# ########################################################################################################################
# mast3rslam-dev
[feature.mast3rslam-dev]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.mast3rslam-dev.system-requirements]
cuda = "12.0"

[feature.mast3rslam-dev.tasks]
git-clone = './git-clone.sh VSLAM-LAB MASt3R-SLAM MASt3R-SLAM-DEV'
install = { cmd = "pip install -e thirdparty/mast3r && pip install -e thirdparty/in3d && pip install --no-build-isolation -e .", cwd = "Baselines/MASt3R-SLAM-DEV" }
execute-mono = { cmd = 'python vslamlab_mast3rslam_mono.py',  cwd = 'Baselines/MASt3R-SLAM-DEV' }

[feature.mast3rslam-dev.dependencies]
# Build Tools
compilers = "*"
pkg-config = "*"
cmake = "*"
make = "*"

# Torch libraries
pytorch-gpu = "*"
torchvision = "*"
lietorch = { version = "*", channel = "fontan" }
torchcodec = "*"

# Other
eigen = "*"
einops = "*"
evo = "*"
faiss = "*"
gradio = "*"
huggingface_hub = "*"
librealsense= "*"
matplotlib = "*"
moderngl = "*"
moderngl-window = { version = "=2.4.6", channel = "fontan" }
msgpack-python = "*"
natsort = "*"
numpy = "<2"
opencv = "*"
pillow = "*"
plyfile = "*"
pyaml = "*"
pyglet = "*"
pyglfw = "=2.9.0"
pyglm = "*"
pykdtree = "*"
roma = { version = "*", channel = "fontan" }
safetensors = "*"
scikit-learn = "*"
scipy = "*"
tensorboard = "*"
tqdm = "*"
trimesh = "*"
pyrealsense2 = "*"

########################################################################################################################
########################################################################################################################
# dpvo-dev
[feature.dpvo-dev]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.dpvo-dev.system-requirements]
cuda = "12.0"

[feature.dpvo-dev.tasks]
git-clone = './git-clone.sh VSLAM-LAB DPVO DPVO-DEV'
install_DPViewer = { cmd = "pip install . --no-deps --no-build-isolation --use-pep517", cwd = "Baselines/DPVO-DEV/DPViewer" }
install = { cmd = "pip install . --no-deps --no-build-isolation", cwd = "Baselines/DPVO-DEV", depends-on = ["install_DPViewer"] }
execute-mono = { cmd = 'python vslamlab_dpvo_mono.py' ,cwd = 'Baselines/DPVO-DEV' }

[feature.dpvo-dev.dependencies]
# Build Tools
compilers = "*"
pkg-config = "*"
cmake = "*"
make = "*"

# Python & Build Tools
pybind11 = "*"
glew = "*"
wayland = "*"

# Torch libraries
pytorch-gpu = "*"
torchvision = "*"
pytorch_scatter = "*"

# Core Libraries
numpy = "*"
tqdm = "*"
einops = "*"
opencv = "*"
eigen = "*"

# Specialized Libraries
pypose = { channel="fontan" }
plyfile = "*"

# Logging, Evaluation & Visualization
pangolin = { channel="fontan" }
tensorboard = "*"
evo = "*"
numba = "*"
kornia  = "*"   
yacs = "*"

########################################################################################################################
########################################################################################################################
# monogs-dev
[feature.monogs-dev]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.monogs-dev.system-requirements]
cuda = "12.0"

[feature.monogs-dev.tasks]
git-clone = "./git-clone.sh VSLAM-LAB MonoGS MonoGS-DEV"
install = { cmd = "pip install submodules/simple-knn submodules/diff-gaussian-rasterization", cwd = "Baselines/MonoGS-DEV" }
execute-mono = { cmd = 'python vslamlab_monogs_mono.py', cwd = "Baselines/MonoGS-DEV" }

[feature.monogs-dev.dependencies]
# Build Tools
compilers = "*"
pkg-config = "*"
cmake = "*"
make = "*"

# Core Libraries
pytorch-gpu = "*"
torchvision = "*"
pytorch_scatter = "*"
numpy = "<2"
opencv = "*"

# Logging, Evaluation & Visualization
evo = "*"
plyfile = "*"
munch = "*"
trimesh = "*"
wandb = "*"
torchmetrics = "*"
imgviz = "*"
pyopengl = "*"
glfw = "*"
pyglm  = "*"
lpips = "*"
rich = "*"
ruff = "*"
nbformat = "==5.7.0"
pyglfw = "*"

[feature.monogs-dev.pypi-dependencies]
open3d = "==0.17.0"

########################################################################################################################
########################################################################################################################
# orbslam2-dev
[feature.orbslam2-dev]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.orbslam2-dev.tasks]
git-clone = "./git-clone.sh VSLAM-LAB ORB_SLAM2 ORB_SLAM2-DEV"
install = { cmd = "./build.sh", cwd = "Baselines/ORB_SLAM2-DEV" }
execute-mono = { cmd = "./bin/vslamlab_orbslam2_mono",  cwd = "Baselines/ORB_SLAM2-DEV" }
execute-rgbd = { cmd = "./bin/vslamlab_orbslam2_rgbd",  cwd = "Baselines/ORB_SLAM2-DEV" }
execute-stereo = { cmd = "./bin/vslamlab_orbslam2_stereo",  cwd = "Baselines/ORB_SLAM2-DEV" }

[feature.orbslam2-dev.dependencies]
compilers = "*"
ninja = ">=1.12.1 ,<1.13"
cmake = ">=3.31.1 ,<3.32"
pkg-config = ">=0.29.2 ,<0.30"
opencv = ">=4.10.0 ,<5"
eigen = ">=3.4.0 ,<3.5.0"
yaml-cpp = ">=0.8.0,<0.9"
pangolin = { channel="fontan" }

########################################################################################################################
########################################################################################################################
# anyfeature-dev
[feature.anyfeature-dev]
channels = ["fontan", "https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.anyfeature-dev.tasks]
git-clone = "./git-clone.sh alejandrofontan AnyFeature-VSLAM AnyFeature-VSLAM-DEV"
install = { cmd = "./build.sh", cwd = "Baselines/AnyFeature-VSLAM-DEV" }
execute-mono = { cmd = "./bin/vslamlab_anyfeature_mono",  cwd = "Baselines/AnyFeature-VSLAM-DEV" }

[feature.anyfeature-dev.dependencies]
compilers = "*"
ninja = ">=1.12.1 ,<1.13"
cmake = ">=3.29.4 ,<3.32"
pkg-config = ">=0.29.2 ,<0.30"
eigen  = ">=3.4.0 ,<3.5.0"
yaml-cpp = ">=0.8.0,<0.9"
opencv = { channel="fontan" }
pangolin = { channel="fontan" }
brisk = { channel="fontan" }
akaze = { channel="fontan" }
siftgpu = { channel="fontan" }
g2o = { channel="fontan" }

huggingface_hub = "*"
pandas = "*"

########################################################################################################################
########################################################################################################################
# gensfm-dev
[feature.gensfm-dev]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.gensfm-dev.system-requirements]
cuda = "12.0"

[feature.gensfm-dev.tasks]
git-clone = "./git-clone.sh VSLAM-LAB GenSfM GenSfM-DEV"
install = { cmd = "./vslamlab_gensfm-dev_build.sh -v && sudo /sbin/swapoff -a && sudo /sbin/swapon -a", cwd = "Baselines/GenSfM-DEV" }
execute-mono = { cmd = "./vslamlab_gensfm-dev_reconstruction.sh", cwd = "Baselines/GenSfM-DEV" }

[feature.gensfm-dev.dependencies]
compilers = "*"
ninja = "*"
cmake = "<4"
pkg-config = "*"
openmp = "*"
ceres-solver = "2.1.*"
libboost-devel = "*"
eigen = "*"
freeimage = "*"
glog = "*"
glew = "*"
git = "*"
qt-main = "*"
pybind11 = "*"
yq = "*"
numpy = "*"
scipy = "*"

# ########################################################################################################################
# ########################################################################################################################
# mast3r-dev
[feature.mast3r-dev]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.mast3r-dev.system-requirements]
cuda = "12.0"

[feature.mast3r-dev.tasks]
git-clone = "./git-clone.sh VSLAM-LAB MASt3R MASt3R-DEV"
install = { cmd = "cd asmk && pip install . && cd .. && cd dust3r/croco/models/curope/ && python setup.py build_ext --inplace", cwd = "Baselines/MASt3R-DEV" }
execute-mono = { cmd = 'python3 vslamlab_mast3r_demo.py',  cwd = 'Baselines/MASt3R-DEV'}
execute-online-demo = { cmd = 'python3 demo.py --model_name MASt3R_ViTLarge_BaseDecoder_512_catmlpdpt_metric',  cwd = 'Baselines/MASt3R-DEV' }

[feature.mast3r-dev.dependencies]
# Build Tools
compilers = "*"
pkg-config = "*"
cmake = "*"
make = "*"

# Torch libraries
pytorch-gpu = "*"
torchvision = "*"

# Other
einops = "*"
faiss = "*"
pydantic = "<2.11.0"
huggingface_hub = "*"
matplotlib = "*"
numpy = "<2"
opencv = "*"
pyaml = "*"
pyglet = "<2"
safetensors = "*"
scipy = "*"
tensorboard = "*"
tqdm = "*"
trimesh = "*"
cython = "*"
scikit-learn = "*"

[feature.mast3r-dev.pypi-dependencies]
roma = "*"
gradio = "*"

########################################################################################################################
########################################################################################################################
# vggt-dev
[feature.vggt-dev]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.vggt-dev.dependencies]

# Core Libraries
pytorch-gpu = "*"
torchvision = "*"

numpy = "<2"
Pillow = "*"
huggingface_hub = "*"
einops = "*"
safetensors = "*"
opencv = "*"
tqdm = "*"
hydra-core = "*"
omegaconf = "*"
scipy = "*"
onnxruntime = "*"
requests = "*"
trimesh = "*"
matplotlib = "*"
gradio = "*"
viser = "*"

[feature.vggt-dev.tasks]
git-clone = "./git-clone.sh VSLAM-LAB vggt VGGT-DEV"
execute-mono = { cmd = 'python vslamlab_vggt.py', cwd = "Baselines/VGGT-DEV" }

# ########################################################################################################################
# ########################################################################################################################
# orbslam3-dev
[feature.orbslam3-dev]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.orbslam3-dev.tasks]
git-clone = "./git-clone.sh VSLAM-LAB ORB_SLAM3 ORB_SLAM3-DEV"
install = { cmd = "./build.sh", cwd = "Baselines/ORB_SLAM3-DEV" }
execute-mono_vi = { cmd = "./bin/vslamlab_orbslam3_mono_vi",  cwd = "Baselines/ORB_SLAM3-DEV" }

[feature.orbslam3-dev.dependencies]
compilers = "*"
ninja = ">=1.12.1 ,<1.13"
cmake = ">=3.31.1 ,<3.32"
pkg-config = ">=0.29.2 ,<0.30"
opencv = ">=4.10.0 ,<5"
eigen = ">=3.4.0 ,<3.5.0"
yaml-cpp = ">=0.8.0,<0.9"
pangolin = { channel="fontan" }
boost = "*"

# ########################################################################################################################
# ########################################################################################################################
# okvis2-dev
[feature.okvis2-dev]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.okvis2-dev.system-requirements]
cuda = "12.0"

[feature.okvis2-dev.tasks]
git-clone = "./git-clone.sh VSLAM-LAB okvis2 OKVIS2-DEV"
install = { cmd = "./build.sh", cwd = "Baselines/OKVIS2-DEV" }
execute-mono_vi = { cmd = "./bin/vslamlab_okvis2_mono_vi",  cwd = "Baselines/OKVIS2-DEV" }

[feature.okvis2-dev.dependencies]
cmake = "<4"
glog = "*"
blas = "*"
lapack = "*"
eigen = "*"
suitesparse = "*"
boost = "*"
opencv = "*"
libtorch = "*"
librealsense = "*"
openmp = "*"
libgfortran = "3.*"